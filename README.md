# l2raw

üì° –†–∞–±–æ—Ç–∞ —Å RAW-–ø–∞–∫–µ—Ç–∞–º–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–∞–Ω–∞–ª—å–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è (L2) –≤ Node.js —á–µ—Ä–µ–∑ –Ω–∞—Ç–∏–≤–Ω—ã–π C-–∞–¥–¥–æ–Ω.

> –î–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞–ø—Ä—è–º—É—é –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å Ethernet-–ø–∞–∫–µ—Ç—ã —á–µ—Ä–µ–∑ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å. –û—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –∏–ª–∏ —Å–∏–º—É–ª—è—Ü–∏–∏ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞.

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
npm install c9js/l2raw
```

---

## üì• –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤

–ü—Ä–∏–º–µ—Ä: [`test/scan.js`](test/scan.js)

```js
const { Scanner } = require('l2raw');

const scanner = new Scanner({ iface: 'eth0' });

scanner.on('data', (packetBuffer) => {
    console.log('–ü–∞–∫–µ—Ç –ø–æ–ª—É—á–µ–Ω: ', packetBuffer.toString('hex'));
});
```

---

## üì• –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ broadcast-–ø–∞–∫–µ—Ç–æ–≤

–ü—Ä–∏–º–µ—Ä: [`test/scan.js`](test/scan.js)

```js
const { Scanner } = require('l2raw');

const scanner = new Scanner({ iface: 'eth0' });

scanner.on('data', (packetBuffer, packet, isBroadcast) => {
// –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ broadcast-–ø–∞–∫–µ—Ç—ã (MAC-–∞–¥—Ä–µ—Å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è FF:FF:FF:FF:FF:FF)
    if (!isBroadcast(packet)) return;
    
// –í—ã–≤–æ–¥–∏–º –≤ –∫–æ–Ω—Å–æ–ª—å
    console.log('–ü–∞–∫–µ—Ç –ø–æ–ª—É—á–µ–Ω:', packetBuffer.toString('hex'));
});
```

---

## üì• –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ MAC-–∞–¥—Ä–µ—Å—É

–ü—Ä–∏–º–µ—Ä: [`test/scan-mac-filter.js`](test/scan-mac-filter.js)

```js
const { Scanner } = require('l2raw');

const scanner = new Scanner({ iface: 'eth0' });

scanner.on('data', (packetBuffer, packet, macFilter) => {
// –°–æ–∑–¥–∞–µ–º MAC-–∞–¥—Ä–µ—Å –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–∞–∫–µ—Ç–æ–≤ (22:33:44:55:66:77)
    const macBuffer = Buffer.from('223344556677', 'hex');
    
// –§–∏–ª—å—Ç—Ä—É–µ–º –ø–∞–∫–µ—Ç—ã –ø–æ MAC-–∞–¥—Ä–µ—Å—É (–ø–æ–ª—É—á–∞–µ–º –ø–∞–∫–µ—Ç—ã —Ç–æ–ª—å–∫–æ –æ—Ç –∑–∞–¥–∞–Ω–Ω–æ–≥–æ MAC-–∞–¥—Ä–µ—Å–∞)
    if (!macFilter(packet, macBuffer)) return;
    
// –í—ã–≤–æ–¥–∏–º –≤ –∫–æ–Ω—Å–æ–ª—å
    console.log('–ü–∞–∫–µ—Ç –ø–æ–ª—É—á–µ–Ω:', packetBuffer.toString('hex'));
    console.log('MAC-–∞–¥—Ä–µ—Å (—Ñ–∏–ª—å—Ç—Ä):', macBuffer.toString('hex'));
});
```

---

## üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤

–ü—Ä–∏–º–µ—Ä: [`test/send.js`](test/send.js)

```js
const { Sender } = require('l2raw');

const sender = new Sender({ iface: 'eth0' });

// –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞–∫–µ—Ç –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
sender.update(Buffer.from('1122334455667788', 'hex'));

// –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∞–∫–µ—Ç–æ–≤
sender.on('data', (packetBuffer) => {
    console.log('–ü–∞–∫–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω: ', packetBuffer.toString('hex'));
});
```

---

## üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π MAC-–∞–¥—Ä–µ—Å

–ü—Ä–∏–º–µ—Ä: [`test/send.js`](test/send.js)

```js
const { Sender } = require('l2raw');

const sender = new Sender({ iface: 'eth0' });

// –û–±–Ω–æ–≤–ª—è–µ–º MAC-–∞–¥—Ä–µ—Å –ø–æ–ª—É—á–∞—Ç–µ–ª—è
sender.updateMac(Buffer.from('223344556677', 'hex'));

// –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞–∫–µ—Ç –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
sender.update(Buffer.from('0000000000004321', 'hex'));

// –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∞–∫–µ—Ç–æ–≤ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π MAC-–∞–¥—Ä–µ—Å
sender.on('data', (packetBuffer, macBuffer) => {
    console.log('–ü–∞–∫–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω: ', packetBuffer.toString('hex'));
    console.log('MAC-–∞–¥—Ä–µ—Å –ø–æ–ª—É—á–∞—Ç–µ–ª—è: ', macBuffer.toString('hex'));
});
```

---

## üîß API

### `new Scanner(options)`

- `iface` ‚Äî –ò–º—è —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `'eth0'`)
- `delay` ‚Äî –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏ (`100` –º—Å / 0.1 —Å–µ–∫)
- `delayError` ‚Äî –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏ (`60000` –º—Å / 60 —Å–µ–∫)
- `timeout` ‚Äî –í—Ä–µ–º—è –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–∞ (`600000` –º—Å / 10 –º–∏–Ω)

–ú–µ—Ç–æ–¥—ã:

- `scan()` ‚Äî –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–∞–∫–µ—Ç–∞ –±–µ–∑ –∑–∞–¥–µ—Ä–∂–∫–∏

–°–æ–±—ã—Ç–∏—è:

- `data` ‚Äî –ü–∞–∫–µ—Ç –ø–æ–ª—É—á–µ–Ω
- `scan` ‚Äî –ó–∞–ø—É—â–µ–Ω–æ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–∞–∫–µ—Ç–∞ –±–µ–∑ –∑–∞–¥–µ—Ä–∂–∫–∏
- `start` ‚Äî –ü—Ä–∏–µ–º–Ω–∏–∫ –∑–∞–ø—É—â–µ–Ω
- `stop` ‚Äî –ü—Ä–∏–µ–º–Ω–∏–∫ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- `restart`‚Äî –ü—Ä–∏–µ–º–Ω–∏–∫ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- `error` ‚Äî –í–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞
- `exit` ‚Äî –í–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–∏–∑–æ—à–ª–æ –∞–≤–∞—Ä–∏–π–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤–æ—Ä–∫–µ—Ä–∞
- `timeout` ‚Äî –ò—Å—Ç–µ–∫–ª–æ –≤—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞–∫–µ—Ç–∞ (–ø—Ä–∏–µ–º–Ω–∏–∫ –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω)

---

### `new Sender(options)`

- `iface` ‚Äî –ò–º—è —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `'eth0'`)
- `delay` ‚Äî –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏ (`100` –º—Å / 0.1 —Å–µ–∫)
- `delayError` ‚Äî –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏ (`60000` –º—Å / 60 —Å–µ–∫)
- `timeout` ‚Äî –í—Ä–µ–º—è –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É –ø–∞–∫–µ—Ç–∞ (`10000` –º—Å / 10 —Å–µ–∫)

–ú–µ—Ç–æ–¥—ã:

- `update(buffer)` ‚Äî –û–±–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
- `updateMac(buffer)` ‚Äî –û–±–Ω–æ–≤–∏—Ç—å MAC-–∞–¥—Ä–µ—Å –ø–æ–ª—É—á–∞—Ç–µ–ª—è

–°–æ–±—ã—Ç–∏—è:

- `data` ‚Äî –ü–∞–∫–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω
- `update` ‚Äî –ü–∞–∫–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω
- `updateMac` ‚Äî MAC-–∞–¥—Ä–µ—Å –æ–±–Ω–æ–≤–ª–µ–Ω
- `start` ‚Äî –ü–µ—Ä–µ–¥–∞—Ç—á–∏–∫ –∑–∞–ø—É—â–µ–Ω
- `stop` ‚Äî –ü–µ—Ä–µ–¥–∞—Ç—á–∏–∫ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- `restart`‚Äî –ü–µ—Ä–µ–¥–∞—Ç—á–∏–∫ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- `error` ‚Äî –í–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞
- `exit` ‚Äî –í–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–∏–∑–æ—à–ª–æ –∞–≤–∞—Ä–∏–π–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤–æ—Ä–∫–µ—Ä–∞
- `timeout` ‚Äî –ò—Å—Ç–µ–∫–ª–æ –≤—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∞–∫–µ—Ç–∞ (–ø–µ—Ä–µ–¥–∞—Ç—á–∏–∫ –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω)

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
l2raw/
‚îú‚îÄ‚îÄ index.js                 # –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç Scanner –∏ Sender
‚îú‚îÄ‚îÄ build/Release/l2raw.node # –°–æ–±—Ä–∞–Ω–Ω—ã–π –±–∏–Ω–∞—Ä–Ω—ã–π –º–æ–¥—É–ª—å (–ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏)
‚îÇ
‚îú‚îÄ‚îÄ test/
‚îÇ   ‚îú‚îÄ‚îÄ scan.js              # –ü—Ä–∏–º–µ—Ä –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞–∫–µ—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ scan-mac-filter.js   # –ü—Ä–∏–º–µ—Ä –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞–∫–µ—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ MAC-–∞–¥—Ä–µ—Å—É
‚îÇ   ‚îî‚îÄ‚îÄ send.js              # –ü—Ä–∏–º–µ—Ä –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∞–∫–µ—Ç–æ–≤
‚îÇ
‚îî‚îÄ‚îÄ lib/
    ‚îú‚îÄ‚îÄ utils.js             # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
    ‚îú‚îÄ‚îÄ sleep.js             # –†–∞–±–æ—Ç–∞ —Å –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏
    ‚îÇ
    ‚îú‚îÄ‚îÄ addon/
    ‚îÇ   ‚îî‚îÄ‚îÄ l2raw.c          # –ò—Å—Ö–æ–¥–Ω–∏–∫ C-–∞–¥–¥–æ–Ω–∞
    ‚îÇ
    ‚îú‚îÄ‚îÄ scanner/             # –ü—Ä–∏–µ–º–Ω–∏–∫ –ø–∞–∫–µ—Ç–æ–≤
    ‚îÇ   ‚îú‚îÄ‚îÄ scanner.js
    ‚îÇ   ‚îî‚îÄ‚îÄ worker.js
    ‚îÇ
    ‚îî‚îÄ‚îÄ sender/              # –ü–µ—Ä–µ–¥–∞—Ç—á–∏–∫ –ø–∞–∫–µ—Ç–æ–≤
        ‚îú‚îÄ‚îÄ sender.js
        ‚îî‚îÄ‚îÄ worker.js
```

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License
